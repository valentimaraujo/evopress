---
description: Protocolo de Workflow e Defini√ß√£o de Pronto (DoD)
globs: ["**/*.ts", "**/*.tsx"]
---

# üîÑ WORKFLOW & AUTO-CORRECTION RULES

Estas regras definem o protocolo de "Definition of Done" e "Auto-Correction" que o Agente DEVE seguir.

## ‚úÖ DEFINITION OF DONE (DoD)

**Antes de considerar uma tarefa conclu√≠da, voc√™ DEVE:**

1. **Rodar Verifica√ß√£o de Lint (`read_lints`):**
   - Verificar TODOS os arquivos modificados.
   - Corrigir TODOS os erros encontrados (proativamente).
   - M√°ximo de 3 tentativas de auto-corre√ß√£o por arquivo.

2. **Verificar Qualidade do C√≥digo:**
   - **Zero** `console.log`, `console.error` (use logger apropriado se necess√°rio).
   - **Zero** coment√°rios `TODO`, `FIXME`, `XXX` (implemente ou remova).
   - **Zero** c√≥digo comentado.
   - Tipagem expl√≠cita (sem `any`).

3. **Verificar Arquitetura (DDD/BFF):**
   - L√≥gica de neg√≥cio isolada em `src/core/services` ou `src/admin/services`.
   - Route Handlers (`api/**`) atuando apenas como proxies/controllers.
   - Valida√ß√£o de entrada usando Zod/Yup.

## üîß PROTOCOLO DE AUTO-CORRE√á√ÉO

### Quando o Linter encontrar erros:

1. **Primeira Tentativa:** Corrigir erros automaticamente (formatar, imports, tipos).
2. **Segunda Tentativa:** Se persistir, analisar se √© falso-positivo ou erro real. Corrigir.
3. **Terceira Tentativa:** Se persistir, PARE e reporte ao usu√°rio. **N√ÉO entre em loop infinito.**

### Detec√ß√£o de Loops Infinitos
- Se o mesmo erro aparecer 3 vezes: PARE.
- Se a corre√ß√£o do Erro A causa o Erro B, e a corre√ß√£o do Erro B traz o Erro A de volta: PARE.

## üìã CHECKLIST PR√â-RESPOSTA

Antes de finalizar sua resposta:
- [ ] Rodou `read_lints` nos arquivos modificados?
- [ ] Corrigiu erros de import order?
- [ ] Removeu vari√°veis n√£o usadas?
- [ ] Garantiu que n√£o h√° `console.log`?
- [ ] Validou a estrutura de pastas?

**CR√çTICO:** Se `read_lints` mostrar QUALQUER erro, voc√™ deve corrigir antes de marcar como "Conclu√≠do".
